<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Salim AI :: CORE</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap');
*{box-sizing:border-box}

:root{
  --neon:#22d3ee;
  --pink:#ec4899;
  --green:#22c55e;
  --bg:#020617;
}

body{
  margin:0;
  font-family:'JetBrains Mono',monospace;
  background:
    radial-gradient(circle at top,#020617,#000 60%),
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,.03) 0,
      rgba(255,255,255,.03) 1px,
      transparent 1px,
      transparent 3px
    );
  color:#e5e7eb;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}

/* CORE */
.core{
  position:fixed;
  top:50%;
  left:50%;
  width:120px;
  height:120px;
  transform:translate(-50%,-50%);
  border-radius:50%;
  background:radial-gradient(circle,var(--neon),transparent 60%);
  filter:blur(2px);
  animation:pulse 3s infinite;
  opacity:.35;
  z-index:0;
}
.core::before,.core::after{
  content:"";
  position:absolute;
  inset:-18px;
  border-radius:50%;
  border:1px solid rgba(34,211,238,.25);
  animation:spin 10s linear infinite;
}
.core::after{inset:-32px;animation-duration:18s}
@keyframes pulse{50%{transform:translate(-50%,-50%) scale(1.12)}}
@keyframes spin{to{transform:rotate(360deg)}}

/* CHAT */
.chat{
  position:relative;
  z-index:2;
  width:100%;
  max-width:360px;
  height:86vh;
  background:rgba(2,6,23,.92);
  border-radius:18px;
  display:flex;
  flex-direction:column;
  overflow:hidden;
  border:1px solid rgba(34,211,238,.3);
  box-shadow:0 0 30px rgba(34,211,238,.25);
}

.header{
  padding:10px 12px;
  border-bottom:1px solid rgba(34,211,238,.25);
}
.header-title{
  color:var(--neon);
  font-size:12px;
  font-weight:700;
  text-shadow:0 0 10px rgba(34,211,238,.8);
}

/* MODES */
.modes{
  display:flex;
  gap:6px;
  padding:6px;
}
.modes button{
  flex:1;
  font-size:11px;
  padding:6px;
  border-radius:10px;
  border:1px solid rgba(34,211,238,.3);
  background:rgba(2,6,23,.8);
  color:var(--neon);
}
.modes .active{
  background:linear-gradient(135deg,var(--green),#16a34a);
  color:#020617;
}

/* MESSAGES */
.messages{
  flex:1;
  padding:12px;
  overflow-y:auto;
}
.messages::-webkit-scrollbar{display:none}

.msg{
  margin-bottom:10px;
  padding:9px 11px;
  border-radius:12px;
  max-width:82%;
  font-size:12px;
}
.user{
  margin-left:auto;
  background:linear-gradient(135deg,var(--pink),#9333ea);
}
.bot{
  background:rgba(2,6,23,.95);
  border:1px solid rgba(34,211,238,.4);
}

/* INPUT */
.input{
  display:flex;
  gap:6px;
  padding:10px;
  border-top:1px solid rgba(34,211,238,.25);
}
input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid rgba(34,211,238,.35);
  background:rgba(2,6,23,.9);
  color:#e5e7eb;
  font-size:12px;
}
button{
  border:none;
  border-radius:12px;
  padding:0 11px;
  background:rgba(34,211,238,.15);
  color:var(--neon);
}
#sendBtn{
  background:linear-gradient(135deg,var(--green),#16a34a);
  color:#020617;
}
</style>
</head>

<body>

<div class="core"></div>

<div class="chat">
  <div class="header">
    <div class="header-title">SALIM AI ‚ñå CORE ACTIVE</div>
  </div>

  <div class="modes">
    <button onclick="setMode('dev')" id="dev">üë®‚Äçüíª –ö–æ–¥</button>
    <button onclick="setMode('design')" id="design">üé® –î–∏–∑–∞–π–Ω</button>
    <button onclick="setMode('teacher')" id="teacher">üìö –£—á–∏—Ç–µ–ª—å</button>
  </div>

  <div class="messages" id="messages"></div>

  <div class="input">
    <input id="text" placeholder="> –∫–æ–º–∞–Ω–¥–∞ –∏–ª–∏ –≤–æ–ø—Ä–æ—Å..." />
    <button id="voiceBtn">üéô</button>
    <button id="sendBtn">‚Æû</button>
  </div>
</div>

<script>
const messages=document.getElementById("messages");
const input=document.getElementById("text");

let mode=localStorage.getItem("mode")||"dev";
setMode(mode);

let history=JSON.parse(localStorage.getItem("salim_history")||"[]");
history.forEach(m=>add(m.text,m.role));

function setMode(m){
  mode=m;
  localStorage.setItem("mode",m);
  document.querySelectorAll(".modes button").forEach(b=>b.classList.remove("active"));
  document.getElementById(m).classList.add("active");
}

function add(text,role){
  const d=document.createElement("div");
  d.className="msg "+role;
  d.textContent=text;
  messages.appendChild(d);
  messages.scrollTop=messages.scrollHeight;
}

function save(text,role){
  history.push({text,role});
  history=history.slice(-30);
  localStorage.setItem("salim_history",JSON.stringify(history));
}

async function send(){
  const text=input.value.trim();
  if(!text)return;
  input.value="";

  if(text==="/clear"){
    messages.innerHTML="";
    history=[];
    localStorage.removeItem("salim_history");
    return;
  }

  add(text,"user"); save(text,"user");
  add("‚è≥ –ê–Ω–∞–ª–∏–∑ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏...","bot");

  const prefix={
    dev:"–¢—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç. –î–∞–π –∫–æ–¥.\n",
    design:"–¢—ã –¥–∏–∑–∞–π–Ω–µ—Ä.\n",
    teacher:"–¢—ã —É—á–∏—Ç–µ–ª—å.\n"
  }[mode];

  try{
    const res=await fetch("https://salim-ai.onrender.com/api/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:prefix+text})
    });
    const data=await res.json();
    messages.lastChild.textContent=data.reply||"–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞";
    save(data.reply,"bot");
  }catch{
    messages.lastChild.textContent="‚ö† –ü–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è";
  }
}

sendBtn.onclick=send;
input.addEventListener("keydown",e=>e.key==="Enter"&&send());

/* üé§ */
const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
if(SR){
  const r=new SR(); r.lang="ru-RU";
  voiceBtn.onclick=()=>r.start();
  r.onresult=e=>input.value=e.results[0][0].transcript;
}
</script>

</body>
</html>
